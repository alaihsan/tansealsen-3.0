<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Laporan Kelas {{ classroom.name }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Arial', sans-serif; font-size: 12px; }
        @media print {
            @page { size: A4 landscape; margin: 10mm; }
            body { -webkit-print-color-adjust: exact; }
            .no-print { display: none; }
        }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid black; padding: 6px; vertical-align: top; }
        th { background-color: #f3f4f6; }
    </style>
</head>
<body class="p-4" onload="window.print()">

    <!-- HEADER -->
    <div class="text-center mb-6 border-b-2 border-black pb-4">
        <h2 class="text-lg font-bold uppercase">{{ school.name }}</h2>
        <h1 class="text-xl font-black uppercase mt-1">LAPORAN PELANGGARAN KELAS {{ classroom.name }}</h1>
        <p class="text-gray-600">Dicetak pada: <script>document.write(new Date().toLocaleDateString('id-ID'))</script></p>
    </div>

    <!-- TABEL -->
    <table>
        <thead>
            <tr>
                <th class="w-10 text-center">No</th>
                <th class="w-48 text-left">Nama Siswa</th>
                <th class="w-32 text-left">Tanggal</th>
                <th class="w-48 text-left">Pasal / Kategori</th>
                <th class="text-left">Deskripsi Pelanggaran</th>
                <th class="w-24 text-center">Status Remisi</th>
                <th class="w-32 text-center">Dokumentasi</th>
            </tr>
        </thead>
        <tbody>
            {% for v in violations %}
            <tr>
                <td class="text-center">{{ loop.index }}</td>
                <td class="font-bold">{{ v.student.name }}</td>
                <td>{{ v.tanggal_kejadian }}</td>
                <td>
                    <div class="font-bold">{{ v.pasal or '-' }}{% if v.ayats|length > 0 %} - {% for a in v.ayats %}{{ a.description }}{% if not loop.last %}, {% endif %}{% endfor %}{% endif %}</div>
                    <!-- Poin disembunyikan sesuai permintaan -->
                    <!-- <div class="text-xs text-gray-500">{{ v.kategori_pelanggaran }} ({{ v.points }})</div> -->
                    <div class="text-xs text-gray-500">{{ v.kategori_pelanggaran }}</div>
                </td>
                <td>{{ v.description }}</td>
                <td class="text-center">
                    {% if v.is_remitted %}
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs border border-green-200 block">REMISI</span>
                    {% else %}
                        <span class="text-gray-500 text-xs">BELUM</span>
                    {% endif %}
                </td>
                <td class="text-center">
                    {% if v.photos|length > 0 %}
                        <div class="flex flex-wrap gap-1 justify-center">
                            {% for photo in v.photos[:2] %}
                                <img src="{{ url_for('static', filename='uploads/' + photo.filename) }}" class="w-10 h-10 object-cover border border-gray-300">
                            {% endfor %}
                            {% if v.photos|length > 2 %}
                                <span class="text-xs text-gray-500 block w-full">+{{ v.photos|length - 2 }} lainnya</span>
                            {% endif %}
                        </div>
                    {% else %}
                        -
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="7" class="text-center py-8 text-gray-500 italic">Tidak ada data pelanggaran di kelas ini.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="mt-8 text-right px-8">
        <p class="mb-16">Guru BK / Kesiswaan</p>
        <p class="font-bold">( ........................................... )</p>
    </div>

</body>
</html>